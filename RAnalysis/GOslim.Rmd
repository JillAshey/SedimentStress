---
title: "GOslim"
author: "jillashey"
date: "10/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load packages 
library(readr)
library(arsenal)
library(tidyverse)
```

This code uses GO term annotation generated in Nov-Dec 2021 and Jan 2022

# Read in go slim info
```{r}
go.slim <- read_csv("Output/GOSeq/GO-GOslim.csv")
colnames(go.slim) <- c("GO.IDs", "GO.Term", "GO.Slim.Term", "Cat") #rename columns
```

## Acerv
```{r}
# Read in acerv DEG GO terms 
acerv.go <- read.csv("Output/GOSeq/acerv/acerv_sub_ByTreatment_GO.terms_20211104.csv", header = T)
acerv.go <- select(acerv.go, c("gene_id", "category", "term", "ontology", "over_represented_pvalue", "log2FoldChange", "padj", "Treatment_Compare")) # can add treatment compare if interested 
colnames(acerv.go)[2] <-"GO.IDs"
acerv.go$Species <- "A.cervicornis"
acerv.go$Site <- "Florida"
acerv.go <- unique(acerv.go)
length(unique(acerv.go$GO.IDs)) # 366 unique GO terms 

# Merge w/ GO slim and subset by ontology
acerv.go.slim <- merge(acerv.go, go.slim, by="GO.IDs", all = TRUE)
write.csv(acerv.go.slim, "Output/GOSeq/acerv/acerv.go.slim_20220208.csv")

acerv.go.slim.BP <- subset(acerv.go.slim, ontology == "BP")
acerv.go.slim.BP <- unique(acerv.go.slim.BP)
length(unique(acerv.go.slim.BP$GO.IDs)) # 278 unique BP GO terms 
write.csv(acerv.go.slim.BP, "Output/GOSeq/acerv/acerv.go.slim.BP_20220208.csv")

acerv.go.slim.CC <- subset(acerv.go.slim, ontology == "CC")
acerv.go.slim.CC <- unique(acerv.go.slim.CC)
length(unique(acerv.go.slim.CC$GO.IDs)) # 34 unique CC GO terms 
write.csv(acerv.go.slim.CC, "Output/GOSeq/acerv/acerv.go.slim.CC_20220208.csv")

acerv.go.slim.MF <- subset(acerv.go.slim, ontology == "MF")
acerv.go.slim.MF <- unique(acerv.go.slim.MF)
length(unique(acerv.go.slim.MF$GO.IDs)) # 54 unique MF GO terms 
write.csv(acerv.go.slim.MF, "Output/GOSeq/acerv/acerv.go.slim.MF_20220208.csv")
```

## Mcav
```{r}
# Read in Mcav DEG GO terms 
mcav.go <- read.csv("Output/GOSeq/mcav/mcav_ByTreatment_GO.terms_20211109.csv", header = T)
mcav.go <- select(mcav.go, c("gene_id", "category", "term", "ontology", "over_represented_pvalue", "log2FoldChange", "padj", "Treatment_Compare")) # can add treatment compare if interested 
colnames(mcav.go)[2] <-"GO.IDs"
mcav.go$Species <- "M.cavernosa"
mcav.go$Site <- "Florida"
mcav.go <- unique(mcav.go)
length(unique(mcav.go$GO.IDs)) # 220 unique GO terms 

# Merge w/ GO slim and subset by ontology
mcav.go.slim <- merge(mcav.go, go.slim, by="GO.IDs", all = TRUE)
write.csv(mcav.go.slim, "Output/GOSeq/mcav/mcav.go.slim_20220208.csv")

mcav_all.go.slim.BP <- subset(mcav.go.slim, ontology == "BP")
mcav_all.go.slim.BP <- unique(mcav_all.go.slim.BP)
length(unique(mcav_all.go.slim.BP$GO.IDs)) # 158 unique BP GO terms 
write.csv(mcav_all.go.slim.BP, "Output/GOSeq/mcav/mcav.go.slim.BP_20220208.csv")

mcav_all.go.slim.CC <- subset(mcav.go.slim, ontology == "CC")
mcav_all.go.slim.CC <- unique(mcav_all.go.slim.CC)
length(unique(mcav_all.go.slim.CC$GO.IDs)) # 21 unique BP GO terms 
write.csv(mcav_all.go.slim.CC, "Output/GOSeq/mcav/mcav.go.slim.CC_20220208.csv")

mcav_all.go.slim.MF <- subset(mcav.go.slim, ontology == "MF")
mcav_all.go.slim.MF <- unique(mcav_all.go.slim.MF)
length(unique(mcav_all.go.slim.MF$GO.IDs)) # 39 unique BP GO terms 
write.csv(mcav_all.go.slim.MF, "Output/GOSeq/mcav/mcav.go.slim.MF_20220208.csv")
```

## Ofav
```{r}
# Read in Ofav DEG GO terms 
ofav.go <- read.csv("Output/GOSeq/ofav/ofav_ByTreatment_GO.terms_20220111.csv", header = T)
ofav.go <- select(ofav.go, c("gene_id", "category", "term", "ontology", "over_represented_pvalue", "log2FoldChange", "padj", "Treatment_Compare")) # can add treatment compare if interested 
colnames(ofav.go)[2] <-"GO.IDs"
ofav.go$Species <- "O.faveolata"
ofav.go$Site <- "Florida"
ofav.go <- unique(ofav.go)
length(unique(ofav.go$GO.IDs)) # 39 unique GO terms 


# Merge w/ GO slim and subset by ontology
ofav.go.slim <- merge(ofav.go, go.slim, by="GO.IDs", all = TRUE)
write.csv(ofav.go.slim, "Output/GOSeq/ofav/ofav.go.slim_20220208.csv")

ofav_all.go.slim.BP <- subset(ofav.go.slim, ontology == "BP")
ofav_all.go.slim.BP <- unique(ofav_all.go.slim.BP)
length(unique(ofav_all.go.slim.BP$GO.IDs)) # 27 unique BP GO terms 
write.csv(ofav_all.go.slim.BP, "Output/GOSeq/ofav/ofav.go.slim.BP_20220208.csv")

ofav_all.go.slim.CC <- subset(ofav.go.slim, ontology == "CC")
ofav_all.go.slim.CC <- unique(ofav_all.go.slim.CC)
length(unique(ofav_all.go.slim.CC$GO.IDs)) # 3 unique BP GO terms 
write.csv(ofav_all.go.slim.CC, "Output/GOSeq/ofav/ofav.go.slim.CC_20220208.csv")

ofav_all.go.slim.MF <- subset(ofav.go.slim, ontology == "MF")
ofav_all.go.slim.MF <- unique(ofav_all.go.slim.MF)
length(unique(ofav_all.go.slim.MF$GO.IDs)) # 9 unique BP GO terms 
write.csv(ofav_all.go.slim.MF, "Output/GOSeq/ofav/ofav.go.slim.MF_20220208.csv")
```

## Pacuta 
```{r}
# Read in pacuta DEG GO terms
pacuta.go <- read.csv("Output/GOSeq/pacuta/pacuta_ByTreatment_GO.terms_20220121.csv", header = T)
pacuta.go <- select(pacuta.go, c("gene_id", "category", "term", "ontology", "over_represented_pvalue", "log2FoldChange", "padj", "Treatment_Compare")) # can add treatment compare if interested 
colnames(pacuta.go)[2] <-"GO.IDs"
pacuta.go$Species <- "P.acuta"
pacuta.go$Site <- "Hawaii"
pacuta.go <- unique(pacuta.go)
length(unique(pacuta.go$GO.IDs)) # 532 unique GO terms 

# Merge w/ GO slim and subset by ontology
pacuta.go.slim <- merge(pacuta.go, go.slim, by="GO.IDs", all = TRUE)
write.csv(pacuta.go.slim, "Output/GOSeq/pacuta/pacuta.go.slim_20220208.csv")

pacuta_all.go.slim.BP <- subset(pacuta.go.slim, ontology == "BP")
pacuta_all.go.slim.BP <- unique(pacuta_all.go.slim.BP)
length(unique(pacuta_all.go.slim.BP$GO.IDs)) # 380 unique BP GO terms 
write.csv(pacuta_all.go.slim.BP, "Output/GOSeq/pacuta/pacuta.go.slim.BP_20220208.csv")

pacuta_all.go.slim.CC <- subset(pacuta.go.slim, ontology == "CC")
pacuta_all.go.slim.CC <- unique(pacuta_all.go.slim.CC)
length(unique(pacuta_all.go.slim.CC$GO.IDs)) # 25 unique BP GO terms 
write.csv(pacuta_all.go.slim.CC, "Output/GOSeq/pacuta/pacuta.go.slim.CC_20220208.csv")

pacuta_all.go.slim.MF <- subset(pacuta.go.slim, ontology == "MF")
pacuta_all.go.slim.MF <- unique(pacuta_all.go.slim.MF)
length(unique(pacuta_all.go.slim.MF$GO.IDs)) # 126 unique BP GO terms 
write.csv(pacuta_all.go.slim.MF, "Output/GOSeq/pacuta/pacuta.go.slim.MF_20220208.csv")

```

## Plob 
```{r}
# Read in plob DEG GO terms
plob.go <- read.csv("Output/GOSeq/plob/plob_ByTreatment_GO.terms_20211106.csv", header = T)
plob.go <- select(plob.go, c("gene_id", "category", "term", "ontology", "over_represented_pvalue", "log2FoldChange", "padj", "Treatment_Compare")) # can add treatment compare if interested 
colnames(plob.go)[2] <-"GO.IDs"
plob.go$Species <- "P.lobata"
plob.go$Site <- "Hawaii"
plob.go <- unique(plob.go)
length(unique(plob.go$GO.IDs)) # 279 unique GO terms 

# Merge w/ GO slim and subset by ontology
plob.go.slim <- merge(plob.go, go.slim, by="GO.IDs", all = TRUE)
write.csv(plob.go.slim, "Output/GOSeq/plob/plob.go.slim_20220208.csv")

plob_all.go.slim.BP <- subset(plob.go.slim, ontology == "BP")
plob_all.go.slim.BP <- unique(plob_all.go.slim.BP)
length(unique(plob_all.go.slim.BP$GO.IDs)) # 198 unique BP GO terms 
write.csv(plob_all.go.slim.BP, "Output/GOSeq/plob/plob.go.slim.BP_20220208.csv")

plob_all.go.slim.CC <- subset(plob.go.slim, ontology == "CC")
plob_all.go.slim.CC <- unique(plob_all.go.slim.CC)
length(unique(plob_all.go.slim.CC$GO.IDs)) # 31 unique BP GO terms 
write.csv(plob_all.go.slim.CC, "Output/GOSeq/plob/plob.go.slim.CC_20220208.csv")

plob_all.go.slim.MF <- subset(plob.go.slim, ontology == "MF")
plob_all.go.slim.MF <- unique(plob_all.go.slim.MF)
length(unique(plob_all.go.slim.MF$GO.IDs)) # 50 unique BP GO terms 
write.csv(plob_all.go.slim.MF, "Output/GOSeq/plob/plob.go.slim.MF_20220208.csv")
```

## Combine GO slim terms with all species in single df 
```{r}
# Bind all species df together for GO slim plot 
all.go.slim <- rbind(acerv.go.slim, 
                     mcav.go.slim, 
                     ofav.go.slim,
                     pacuta.go.slim, 
                     plob.go.slim)
write.csv(all.go.slim, "Output/GOSeq/all.go.slim_20220208.csv")

# Plot 
all.go.slim <- na.omit(all.go.slim)
GO.all <- ggplot(all.go.slim, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 8),
                     strip.text.x = element_text(size = 8),
                     axis.text = element_text(size = 8))
GO.all
ggsave("Output/Figs/all_GOslim_20220121.pdf", GO.all, width = 40, height = 40, units = c("in"))





# Bind all species df together for BP GO slim plot 
all.go.BP.slim <- rbind(acerv.go.slim.BP, 
                     mcav_all.go.slim.BP, 
                     ofav_all.go.slim.BP,
                     pacuta_all.go.slim.BP, 
                     plob_all.go.slim.BP)
write.csv(all.go.BP.slim, "Output/GOSeq/all.go.BP.slim_20220208.csv")

# Plot 
all.go.BP.slim <- na.omit(all.go.BP.slim)
GO.BP.all <- ggplot(all.go.BP.slim, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 8),
                     strip.text.x = element_text(size = 8),
                     axis.text = element_text(size = 8))
GO.BP.all
ggsave("Output/Figs/all_GOslim.BP_20220121.pdf", GO.BP.all, width = 40, height = 40, units = c("in"))


# Bind all species df together for CC GO slim plot 
all.go.CC.slim <- rbind(acerv.go.slim.CC, 
                     mcav_all.go.slim.CC, 
                     ofav_all.go.slim.CC,
                     pacuta_all.go.slim.CC, 
                     plob_all.go.slim.CC)
write.csv(all.go.CC.slim, "Output/GOSeq/all.go.CC.slim_20220208.csv")

# Plot 
all.go.CC.slim <- na.omit(all.go.CC.slim)
GO.CC.all <- ggplot(all.go.CC.slim, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 8),
                     strip.text.x = element_text(size = 8),
                     axis.text = element_text(size = 8))
GO.CC.all
ggsave("Output/Figs/all_GOslim.CC_20220125.pdf", GO.CC.all, width = 40, height = 40, units = c("in"))


# Bind all species df together for MF GO slim plot and merge w/ GO slim terms
all.go.MF.slim <- rbind(acerv.go.slim.MF, 
                     mcav_all.go.slim.MF, 
                     ofav_all.go.slim.MF,
                     pacuta_all.go.slim.MF, 
                     plob_all.go.slim.MF)
write.csv(all.go.MF.slim, "Output/GOSeq/all.go.MF.slim_20220208.csv")

# Plot 
all.go.MF.slim <- na.omit(all.go.MF.slim)
GO.MF.all <- ggplot(all.go.MF.slim, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 8),
                     strip.text.x = element_text(size = 8),
                     axis.text = element_text(size = 8))
GO.MF.all
ggsave("Output/Figs/all_GOslim.MF_20220125.pdf", GO.MF.all, width = 40, height = 40, units = c("in"))
```

Make bar chart for go slim term counts for all species
```{r}
# read in data
all.go.BP.slim <- read.csv("Output/GOSeq/all.go.BP.slim_20220208.csv", header = T)

# Check species names
unique(all.go.BP.slim$Species)
# "A.cervicornis" "P.lobata"      "P.acuta"       "M.cavernosa"  "O.faveolata"  

# for this plot, remove "other biological processes" and "other metabolic processes"
all.go.BP.slim <- subset(all.go.BP.slim, !GO.Slim.Term == "other biological processes" & !GO.Slim.Term == "other metabolic processes")

# plot by species 
## plotting unique GO terms only - if I plot with all.go.BP.slim, I get duplicate GO slim terms bc its duplicating based on gene id/treatment?
test <- select(all.go.BP.slim, c("GO.IDs", "term", "Species", "GO.Slim.Term"))
test <- unique(test)
test <- na.omit(test)

# count GOslim by species
count_by_group <- test %>%
  dplyr::count(Species, GO.Slim.Term)
count_by_group

# plot
count <- ggplot(count_by_group, aes(fill = Species, y = n, x = GO.Slim.Term)) +
  geom_bar(position = "dodge", 
           stat = "identity", 
           width = 0.9) +
  # geom_text(aes(label = n), 
  #           position = position_dodge(0.9), 
  #           size = 10, 
  #           face = "bold") +
  labs(title="Counts of GO Slim Categories", x ="", y = "Counts") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 65, 
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size=60)) + 
  theme(axis.text.y = element_text(size = 60)) +
  theme(axis.title.y = element_text(size = 40)) +
  theme(plot.title = element_text(size = 100, hjust = 0.5)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 100)) + 
  theme(legend.title = element_text(size = 60), 
        legend.key.size = unit(2, "cm"),
        legend.text = element_text(size=60), 
        legend.position = c(0.85, 0.85), 
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.background = element_rect(fill = "white", color = "black")) + 
  scale_fill_manual(values = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"))
count
ggsave("Output/Figs/SpeciesCounts_GOslim.BP_20220320.pdf", count, width = 40, height = 30, units = c("in"))
ggsave("Output/Figs/SpeciesCounts_GOslim.BP_20220320.png", count, width = 40, height = 30, units = c("in"))

# plot by location/sediment type
all.go.BP.slim <- all.go.BP.slim %>% mutate(Location = 
                                              case_when(Species == "A.cervicornis" ~ "Florida", 
                                                        Species == "M.cavernosa" ~ "Florida",
                                                        Species == "O.faveolata" ~ "Florida",
                                                        Species == "P.acuta" ~ "Hawaii",
                                                        Species == "P.lobata" ~ "Hawaii"))

# count GOslim by location
count_by_location <- all.go.BP.slim %>%
  dplyr::count(Location, GO.Slim.Term)
count_by_location

# plot
count_location_plot <- ggplot(count_by_location, aes(fill = Location, y = n, x = GO.Slim.Term)) +
  geom_bar(position = "dodge", 
           stat = "identity", 
           colour="black",
           width = 0.9,
           size = 2) +
  # geom_text(aes(label = n), 
  #           position = position_dodge(0.9), 
  #           size = 10, 
  #           face = "bold") +
  ylab("GO Term Counts\n") + 
  #ggtitle(label = "Counts of GO Slim Categories by Location") +
  #coord_flip() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 65,
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size=80, 
                                   colour = "black"), 
        axis.text.y = element_text(size = 60, colour = "black"),
        axis.title.y = element_text(size = 80, face = "bold"),
        axis.line = element_line(colour = 'black', size = 2),
        plot.title = element_text(size = 100, hjust = 0.5),
        plot.margin = margin(3,3,3,3, "cm")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 600)) + 
  theme(legend.title = element_text(size = 80), 
        legend.key.size = unit(2, "cm"),
        legend.text = element_text(size=80), 
        legend.position = c(0.85, 0.85), 
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.background = element_rect(fill = "white", color = "black"),
        legend.box.background = element_rect(color="black", size=2)) +
        scale_fill_manual(values = c("chartreuse3", "chocolate2"))
count_location_plot
ggsave("Output/Figs/LocationsCounts_GOslim.BP_20220328.pdf", count_location_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/LocationsCounts_GOslim.BP_20220328.png", count_location_plot, width = 49, height = 40, units = c("in"))

# plot by morphology type
all.go.BP.slim <- all.go.BP.slim %>% mutate(Morphology = 
                                              case_when(Species == "A.cervicornis" ~ "Branching", 
                                                        Species == "M.cavernosa" ~ "Massive",
                                                        Species == "O.faveolata" ~ "Massive",
                                                        Species == "P.acuta" ~ "Branching",
                                                        Species == "P.lobata" ~ "Massive"))

# count GOslim by morphology
count_by_morph <- all.go.BP.slim %>%
  dplyr::count(Morphology, GO.Slim.Term)
count_by_morph

# plot
count_morph_plot <- ggplot(count_by_morph, aes(fill = Morphology, y = n, x = GO.Slim.Term)) +
    geom_bar(position = "dodge", 
           stat = "identity", 
           colour="black",
           width = 0.9,
           size = 2) +
  # geom_text(aes(label = n), 
  #           position = position_dodge(0.9), 
  #           size = 10, 
  #           face = "bold") +
  ylab("GO Term Counts\n") + 
  #ggtitle(label = "Counts of GO Slim Categories by Morphology") +
  #coord_flip() +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 65,
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size=80, 
                                   colour = "black"), 
        axis.text.y = element_text(size = 60, colour = "black"),
        axis.title.y = element_text(size = 80, face = "bold"),
        axis.line = element_line(colour = 'black', size = 2),
        plot.title = element_text(size = 100, hjust = 0.5),
        plot.margin = margin(3,3,3,3, "cm")) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1)), limits = c(0, 650)) + 
  theme(legend.title = element_text(size = 80), 
        legend.key.size = unit(2, "cm"),
        legend.text = element_text(size=80), 
        legend.position = c(0.85, 0.85), 
        legend.justification = c("right", "top"),
        legend.box.just = "right",
        legend.background = element_rect(fill = "white", color = "black"),
        legend.box.background = element_rect(color="black", size=2)) +
        scale_fill_manual(values = c("paleturquoise3", "rosybrown2"))
count_morph_plot
ggsave("Output/Figs/MorphologyCounts_GOslim.BP_20220328.pdf", count_morph_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/MorphologyCounts_GOslim.BP_20220328.png", count_morph_plot, width = 49, height = 40, units = c("in"))
```

## Make contingency tables (info [here](https://www.datacamp.com/community/tutorials/contingency-tables-r))
```{r}
# By location
tabl1 <- table(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Location)
tabl1
  #                                 Florida Hawaii
  # cell adhesion                          8     26
  # cell cycle and proliferation          11     42
  # cell organization and biogenesis      44    119
  # cell-cell signaling                   18     14
  # death                                 14      6
  # developmental processes              174    595
  # DNA metabolism                         7     32
  # protein metabolism                    53     92
  # RNA metabolism                        52     61
  # signal transduction                   52     84
  # stress response                       46     84
  # transport                             63     40

rowSums(tabl1)
       #  cell adhesion     cell cycle and proliferation cell organization and biogenesis              cell-cell signaling 
       #             34                               53                              163                               32 
       #          death          developmental processes                   DNA metabolism               protein metabolism 
       #             20                              769                               39                              145 
       # RNA metabolism              signal transduction                  stress response                        transport 
       #            113                              136                              130                              103 

colSums(tabl1)
# Florida  Hawaii 
#     542    1195
    
prop.table(table(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Location)) * 100
  #                                    Florida     Hawaii
  # cell adhesion                     0.4605642  1.4968336
  # cell cycle and proliferation      0.6332758  2.4179620
  # cell organization and biogenesis  2.5331031  6.8508923
  # cell-cell signaling               1.0362694  0.8059873
  # death                             0.8059873  0.3454231
  # developmental processes          10.0172712 34.2544617
  # DNA metabolism                    0.4029937  1.8422568
  # protein metabolism                3.0512378  5.2964882
  # RNA metabolism                    2.9936672  3.5118020
  # signal transduction               2.9936672  4.8359240
  # stress response                   2.6482441  4.8359240
  # transport                         3.6269430  2.3028210

chisq.test(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Location)
#	Pearson's Chi-squared test
#
# data:  all.go.BP.slim$GO.Slim.Term and all.go.BP.slim$Location
# X-squared = 118.64, df = 11, p-value < 2.2e-16


# By morphology 
tabl2 <- table(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Morphology)
tabl2
  #                                  Branching Massive
  # cell adhesion                           28       6
  # cell cycle and proliferation            43      10
  # cell organization and biogenesis       105      58
  # cell-cell signaling                     26       6
  # death                                   15       5
  # developmental processes                635     134
  # DNA metabolism                          17      22
  # protein metabolism                      99      46
  # RNA metabolism                          91      22
  # signal transduction                     96      40
  # stress response                        109      21
  # transport                               81      22

rowSums(tabl2)
# cell adhesion     cell cycle and proliferation cell organization and biogenesis              cell-cell signaling 
#    34                               53                              163                               32 
# death          developmental processes                   DNA metabolism               protein metabolism 
#  20                              769                               39                              145 
# RNA metabolism              signal transduction                  stress response                        transport 
# 113                              136                              130                              103 

colSums(tabl2)
# Branching   Massive 
#      1345       392
prop.table(table(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Morphology)) * 100
  #                                   Branching    Massive
  # cell adhesion                     1.6119747  0.3454231
  # cell cycle and proliferation      2.4755325  0.5757052
  # cell organization and biogenesis  6.0449050  3.3390904
  # cell-cell signaling               1.4968336  0.3454231
  # death                             0.8635579  0.2878526
  # developmental processes          36.5572827  7.7144502
  # DNA metabolism                    0.9786989  1.2665515
  # protein metabolism                5.6994819  2.6482441
  # RNA metabolism                    5.2389177  1.2665515
  # signal transduction               5.5267703  2.3028210
  # stress response                   6.2751871  1.2089810
  # transport                         4.6632124  1.2665515

chisq.test(all.go.BP.slim$GO.Slim.Term, all.go.BP.slim$Morphology)
# Chi-squared approximation may be incorrect
# 	Pearson's Chi-squared test
# 
# data:  all.go.BP.slim$GO.Slim.Term and all.go.BP.slim$Morphology
# X-squared = 68.59, df = 11, p-value = 2.262e-10
```




# Subset by GO slim term and plot for all species 
In the manuscript, only the BP terms will be presented. The CC and MF terms will be included in the supplementary materials

## BP
### Determine all categories to plot by
```{r}
unique(all.go.BP.slim$GO.Slim.Term)
#  [1] "transport"                        "RNA metabolism"                   "cell organization and biogenesis" "protein metabolism"              
#  [5] "DNA metabolism"                   "stress response"                  "developmental processes"          "other biological processes"      
#  [9] "cell cycle and proliferation"     "cell adhesion"                    "other metabolic processes"        "death"                           
# [13] "signal transduction"              "cell-cell signaling"                                      
```

Look at all_GOslim.BP plot to see which GOslim term has the most associated GO terms. Then, plot by that GOslim term. Going to subset and plot by GOslim terms that appear in all_GOslim.BP_20220121.pdf: 

(1) "cell adhesion"
(2) "cell cycle and proliferation"
(3) "cell organization and biogenesis"
(4) "cell-cell signaling"
(5) "death"
(6) "developmental processes"
(7) "DNA metabolism"
(8) "other biological processes"
(9) "other metabolic processes"
(10) "protein metabolism"
(11) "RNA metabolism"
(12) "signal transduction" 
(13) "stress response"
(14) "transport 


### BP Plots 

(1) "cell adhesion"
```{r}
go.slim.CA.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="cell adhesion")

GO.CA.subset <- ggplot(go.slim.CA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.CA.subset
ggsave("Output/Figs/CA.Subset_GOslim.BP_20220121.pdf", GO.CA.subset, width = 40, height = 40, units = c("in"))
```


(2) "cell cycle and proliferation"
```{r}
go.slim.CCP.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="cell cycle and proliferation")

GO.CCP.subset <- ggplot(go.slim.CCP.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.CCP.subset
ggsave("Output/Figs/CCP.Subset_GOslim.BP_20220121.pdf", GO.CCP.subset, width = 40, height = 40, units = c("in"))
```


(3) "cell organization and biogenesis"
```{r}
go.slim.COB.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="cell organization and biogenesis")

GO.COB.subset <- ggplot(go.slim.COB.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.COB.subset
ggsave("Output/Figs/COB.Subset_GOslim.BP_20220121.pdf", GO.COB.subset, width = 40, height = 40, units = c("in"))
```


(4) "cell-cell signaling"
```{r}
go.slim.CCS.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="cell-cell signaling")

GO.CCS.subset <- ggplot(go.slim.CCS.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.CCS.subset
ggsave("Output/Figs/CCS.Subset_GOslim.BP_20220121.pdf", GO.CCS.subset, width = 40, height = 40, units = c("in"))
```


(5) "death"
```{r}
go.slim.Death.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="death")

GO.death.subset <- ggplot(go.slim.Death.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.death.subset
ggsave("Output/Figs/Death.Subset_GOslim.BP_20220121.pdf", GO.death.subset, width = 40, height = 40, units = c("in"))
```

(6) "developmental processes"
```{r}
go.slim.DP.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="developmental processes")

GO.DP.subset <- ggplot(go.slim.DP.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.DP.subset
ggsave("Output/Figs/DP.Subset_GOslim.BP_20220121.pdf", GO.DP.subset, width = 40, height = 40, units = c("in"))
```


(7) "DNA metabolism"
```{r}
go.slim.DNAM.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="DNA metabolism")

GO.DNAM.subset <- ggplot(go.slim.DNAM.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.DNAM.subset
ggsave("Output/Figs/DNAM.Subset_GOslim.BP_20220121.pdf", GO.DNAM.subset, width = 40, height = 40, units = c("in"))
```

(8) "other biological processes"
```{r}
go.slim.OBP.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="other biological processes")

GO.OBP.subset <- ggplot(go.slim.OBP.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OBP.subset
ggsave("Output/Figs/OBP.Subset_GOslim.BP_20220121.pdf", GO.OBP.subset, width = 40, height = 40, units = c("in"))
```

(9) "other metabolic processes"
```{r}
go.slim.OMP.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="other metabolic processes")

GO.OMP.subset <- ggplot(go.slim.OMP.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OMP.subset
ggsave("Output/Figs/OMP.Subset_GOslim.BP_20220121.pdf", GO.OMP.subset, width = 40, height = 40, units = c("in"))
```

(10) "protein metabolism"
```{r}
go.slim.PM.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="protein metabolism")

GO.PM.subset <- ggplot(go.slim.PM.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.PM.subset
ggsave("Output/Figs/PM.Subset_GOslim.BP_20220121.pdf", GO.PM.subset, width = 40, height = 40, units = c("in"))
```


(11) "RNA metabolism"
```{r}
go.slim.RNAM.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="RNA metabolism")

GO.RNAM.subset <- ggplot(go.slim.RNAM.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.RNAM.subset
ggsave("Output/Figs/RNAM.Subset_GOslim.BP_20220121.pdf", GO.RNAM.subset, width = 40, height = 40, units = c("in"))
```

(12) "signal transduction"
```{r}
go.slim.ST.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="signal transduction")

GO.ST.subset <- ggplot(go.slim.ST.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.ST.subset
ggsave("Output/Figs/ST.Subset_GOslim.BP_20220121.pdf", GO.ST.subset, width = 40, height = 40, units = c("in"))
```

(13) "stress response"
```{r}
go.slim.SR.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="stress response")

GO.SR.subset <- ggplot(go.slim.SR.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.SR.subset
ggsave("Output/Figs/SR.Subset_GOslim.BP_20220121.pdf", GO.SR.subset, width = 40, height = 40, units = c("in"))
```

(14) "transport"
```{r}
go.slim.T.subset <- all.go.BP.slim %>% filter(GO.Slim.Term=="transport")

GO.T.subset <- ggplot(go.slim.T.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.T.subset
ggsave("Output/Figs/Transport.Subset_GOslim.BP_20220121.pdf", GO.T.subset, width = 40, height = 40, units = c("in"))
```



## CC
### Determine all categories to plot by
```{r}
unique(all.go.CC.slim$GO.Slim.Term)
# [1] "nucleus"                      "other cellular component"     "other membranes"              "other cytoplasmic organelle" 
# [5] "cytoskeleton"                 "plasma membrane"              "non-structural extracellular" "mitochondrion"               
# [9] "ER/Golgi"                                      
```

Look at all_GOslim.CC plot to see which GOslim term has the most associated GO terms. Then, plot by that GOslim term. Going to subset and plot by GOslim terms that appear in all_GOslim.CC_20220125.pdf: 

(1) cytoskeleton
(2) ER/Golgi
(3) plasma membrane
(4) mitochondrion
(5) non-structural extracellular
(6) nucleus
(7) other cellular component
(8) other cytoplasmic organelle
(9) other membranes


(1) "cytoskeleton"
```{r}
go.slim.Cytoskeleton.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="cytoskeleton")

GO.Cytoskeleton.subset <- ggplot(go.slim.Cytoskeleton.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.Cytoskeleton.subset
ggsave("Output/Figs/Cytoskeleton.Subset_GOslim.CC_20220125.pdf", GO.Cytoskeleton.subset, width = 40, height = 40, units = c("in"))
```

(2) "ER/Golgi"
```{r}
go.slim.EG.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="ER/Golgi")

GO.EG.subset <- ggplot(go.slim.EG.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.EG.subset
ggsave("Output/Figs/EG.Subset_GOslim.CC_20220125.pdf", GO.EG.subset, width = 40, height = 40, units = c("in"))
```

(3) "plasma membrane"
```{r}
go.slim.PMem.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="plasma membrane")

GO.PMem.subset <- ggplot(go.slim.PMem.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.PMem.subset
ggsave("Output/Figs/PMem.Subset_GOslim.CC_20220125.pdf", GO.PMem.subset, width = 40, height = 40, units = c("in"))
```

(4) 'mitochondrion'
```{r}
go.slim.Mito.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="mitochondrion")

GO.Mito.subset <- ggplot(go.slim.Mito.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.Mito.subset
ggsave("Output/Figs/Mito.Subset_GOslim.CC_20220125.pdf", GO.Mito.subset, width = 40, height = 40, units = c("in"))
```

(5) 'non-structural extracellular'
```{r}
go.slim.NSE.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="non-structural extracellular")

GO.NSE.subset <- ggplot(go.slim.NSE.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.NSE.subset
ggsave("Output/Figs/NSE.Subset_GOslim.CC_20220125.pdf", GO.NSE.subset, width = 40, height = 40, units = c("in"))
```

(6) 'nucleus'
```{r}
go.slim.Nucleus.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="nucleus")

GO.Nucleus.subset <- ggplot(go.slim.Nucleus.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.Nucleus.subset
ggsave("Output/Figs/Nucleus.Subset_GOslim.CC_20220125.pdf", GO.Nucleus.subset, width = 40, height = 40, units = c("in"))
```

(7) 'other cellular component'
```{r}
go.slim.OCC.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="other cellular component")

GO.OCC.subset <- ggplot(go.slim.OCC.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OCC.subset
ggsave("Output/Figs/OCC.Subset_GOslim.CC_20220125.pdf", GO.OCC.subset, width = 40, height = 40, units = c("in"))
```

(8) 'other cytoplasmic organelle'
```{r}
go.slim.OCO.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="other cytoplasmic organelle")

GO.OCO.subset <- ggplot(go.slim.OCO.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OCO.subset
ggsave("Output/Figs/OCO.Subset_GOslim.CC_20220125.pdf", GO.OCO.subset, width = 40, height = 40, units = c("in"))
```

(9) 'other membranes'
```{r}
go.slim.OM.subset <- all.go.CC.slim %>% filter(GO.Slim.Term=="other membranes")

GO.OM.subset <- ggplot(go.slim.OM.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OM.subset
ggsave("Output/Figs/OM.Subset_GOslim.CC_20220125.pdf", GO.OM.subset, width = 40, height = 40, units = c("in"))
```



## MF
### Determine all categories to plot by
```{r}
unique(all.go.MF.slim$GO.Slim.Term)
# [1] "other molecular function"          "transporter activity"              "signal transduction activity"      "kinase activity"                  
# [5] "nucleic acid binding activity"     "transcription regulatory activity" "cytoskeletal activity"             "enzyme regulator activity"                                
```

Look at all_GOslim.MF plot to see which GOslim term has the most associated GO terms. Then, plot by that GOslim term. Going to subset and plot by GOslim terms that appear in all_GOslim.MF_20220125.pdf: 


(1) cytoskeletal activity
(2) enzyme regulator activity
(3) kinase activity
(4) nucleic acid binding activity
(5) other molecular function
(6) signal transduction activity
(7) transcription regulatory activity
(8) transporter activity


(1) 'cytoskeletal activity'
```{r}
go.slim.CytoA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="cytoskeletal activity")

GO.CtyoA.subset <- ggplot(go.slim.CytoA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.CtyoA.subset
ggsave("Output/Figs/CytoA.Subset_GOslim.MF_20220125.pdf", GO.CtyoA.subset, width = 40, height = 40, units = c("in"))
```

(2) 'enzyme regulator activity'
```{r}
go.slim.ERA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="enzyme regulator activity")

GO.ERA.subset <- ggplot(go.slim.ERA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.ERA.subset
ggsave("Output/Figs/ERA.Subset_GOslim.MF_20220125.pdf", GO.ERA.subset, width = 40, height = 40, units = c("in"))
```

(3) 'kinase activity'
```{r}
go.slim.KA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="kinase activity")

GO.KA.subset <- ggplot(go.slim.KA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.KA.subset
ggsave("Output/Figs/KA.Subset_GOslim.MF_20220125.pdf", GO.KA.subset, width = 40, height = 40, units = c("in"))
```

(4) 'nucleic acid binding activity'
```{r}
go.slim.NABA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="nucleic acid binding activity")

GO.NABA.subset <- ggplot(go.slim.NABA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.NABA.subset
ggsave("Output/Figs/NABA.Subset_GOslim.MF_20220125.pdf", GO.NABA.subset, width = 40, height = 40, units = c("in"))
```

(5) 'other molecular function'
```{r}
go.slim.OMF.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="other molecular function")

GO.OMF.subset <- ggplot(go.slim.OMF.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.OMF.subset
ggsave("Output/Figs/OMG.Subset_GOslim.MF_20220125.pdf", GO.OMF.subset, width = 40, height = 40, units = c("in"))
```

(6) 'signal transduction activity'
```{r}
go.slim.STA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="signal transduction activity")

GO.STA.subset <- ggplot(go.slim.STA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.STA.subset
ggsave("Output/Figs/STA.Subset_GOslim.MF_20220125.pdf", GO.STA.subset, width = 40, height = 40, units = c("in"))
```

(7) 'transcription regulatory activity'
```{r}
go.slim.TRA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="transcription regulatory activity")

GO.TRA.subset <- ggplot(go.slim.TRA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.TRA.subset
ggsave("Output/Figs/TRA.Subset_GOslim.MF_20220125.pdf", GO.TRA.subset, width = 40, height = 40, units = c("in"))
```

(8) 'transporter activity'
```{r}
go.slim.TA.subset <- all.go.MF.slim %>% filter(GO.Slim.Term=="transporter activity")

GO.TA.subset <- ggplot(go.slim.TA.subset, aes(x = Species, y = term)) + 
  geom_tile(aes(fill =over_represented_pvalue)) + 
  facet_grid(GO.Slim.Term ~ ., scales = "free_y", labeller = label_wrap_gen(width = 5, multi_line = TRUE))+
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     strip.text.y = element_text(angle=0, size = 25),
                     strip.text.x = element_text(size = 25),
                     axis.text = element_text(size = 30))
GO.TA.subset
ggsave("Output/Figs/TA.Subset_GOslim.MF_20220125.pdf", GO.TA.subset, width = 40, height = 40, units = c("in"))
```




Plot by species?