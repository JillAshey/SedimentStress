---
title: "HI & FL sea surface temperatures"
author: "jillashey"
date: "2022-09-13"
output: html_document
---

This script plots the sea surface temperature of HI June 2015 and FL summer 2016. These dates correspond to when the sediment stress experiments were happening in these locations.

## Load packages 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(lubridate)
library(tidyr)
library(ggplot2)
library(plotrix)
library(tidyverse)
library(dplyr)
library(reshape2)
library(gridExtra)
library(FSA)
library(naniar)
library(scales)

```

Before loading data, I separated the text into columns in Excel and deleted the 2nd row (extra header) in each text file. Now all variables should be in their own column and there is only one heading per column. 

## Hawaii temperature 

Hawaii 2015 temperature data was obtained from NOAA buoy (Station 51207 - Kaneohe Bay, HI (198)). 

### Load and organize data 
```{r}
HI_temp <- read.csv("Data/KaneoheBay_2015.txt", sep="\t", skip=c(0), header=TRUE, na.strings = "NA")[,c(1:5,15)]
HI_temp$Date <- paste0(HI_temp$X.YY, sep = "-", HI_temp$MM, sep = "-", HI_temp$DD)
HI_temp$Time <- paste0(HI_temp$hh, sep = ":", HI_temp$mm)
HI_temp$Date.Time <- paste0(HI_temp$Date, sep=" ", HI_temp$Time)
HI_temp <- HI_temp %>% naniar::replace_with_na(HI_temp, replace = list(WTMP=c("9   9.", ".0 999", "999", "0 999."))) # replace all weird enteries with NAs
```

### Parse date & time 
```{r}
HI_temp$Date.Time <- as.POSIXct(paste(HI_temp$Date, HI_temp$Time), format="%Y-%m-%d %H:%M", tz = "HST")
```

### Subset for June 1 - June 15
```{r}
HI_temp_sub <- HI_temp %>% 
  filter(Date.Time > as.POSIXct("2015-06-01 00:03:00"), Date.Time < as.POSIXct("2015-06-15 23:00:00"))

#HI_temp%>% filter(Date.Time < as.POSIXct("2015-06-01 08:00:00")) %>%summarise(mean=mean(WTMP),sd=sd(WTMP),se=std.error(WTMP))
```

### Plot Hawaii temps during experimental period 
```{r}
HI_plot <- ggplot(HI_temp_sub, aes(x=Date.Time, y=WTMP)) +
  geom_line(size = 9) + 
  theme_bw() +
  scale_x_datetime(date_breaks = "1 day", labels = date_format("%b %d")) + 
  ylab("Temperature (°C)") + 
  xlab("") + 
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, 
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size = 80)) + 
  theme(axis.text.y = element_text(size = 80)) +
  theme(axis.title.y = element_text(size = 80)) +
  theme(axis.text.x = element_text(size = 80)) 
HI_plot

# save plot
ggsave("Output/Figs/Temperature/HI_temperature_2015.pdf", HI_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/Temperature/HI_temperature_2015.png", HI_plot, width = 49, height = 40, units = c("in"))
```


## Florida temperature 

Florida 2016 temperature data was obtained from NOAA buoy (Station KYWF1 - 8724580 - Key West, FL). 

### Load and organize data 
```{r}
FL_temp <- read.csv("Data/KeyWest_2016.txt", sep="\t", skip=c(0), header=TRUE, na.strings = "NA")[,c(1:5,15)]
FL_temp$Date <- paste0(FL_temp$X.YY, sep = "-", FL_temp$MM, sep = "-", FL_temp$DD)
FL_temp$Time <- paste0(FL_temp$hh, sep = ":", FL_temp$mm)
FL_temp$Date.Time <- paste0(FL_temp$Date, sep=" ", FL_temp$Time)
FL_temp <- FL_temp %>% naniar::replace_with_na(FL_temp, replace = list(WTMP=c("999"))) # replace all weird enteries with NAs
FL_temp <- na.omit(FL_temp)
```

### Parse date and time
```{r}
FL_temp$Date.Time <- as.POSIXct(paste(FL_temp$Date, FL_temp$Time), format="%Y-%m-%d %H:%M", tz = "EST")
```

### Subset for July to October

Need to figure out dates of FL experiment
```{r}
FL_temp_sub <- FL_temp %>% 
  filter(Date.Time > as.POSIXct("2016-07-01 00:03:00"), Date.Time < as.POSIXct("2016-10-31 23:00:00"))
```

### Plot Florida temps during experimental period 
```{r}
FL_plot <- ggplot(FL_temp_sub, aes(x=Date.Time, y=WTMP)) +
  geom_line(size = 9) + 
  theme_bw() +
  scale_x_datetime(date_breaks = "7 day", labels = date_format("%b %d")) + 
  ylab("Temperature (°C)") + 
  xlab("") + 
    theme_bw() +
  theme(axis.text.x = element_text(angle = 45, 
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size = 80)) + 
  theme(axis.text.y = element_text(size = 80)) +
  theme(axis.title.y = element_text(size = 80)) +
  theme(axis.text.x = element_text(size = 80)) 
FL_plot

# save plot
ggsave("Output/Figs/Temperature/FL_temperature_2016.pdf", FL_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/Temperature/FL_temperature_2016.png", FL_plot, width = 49, height = 40, units = c("in"))
```















