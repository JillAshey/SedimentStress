---
title: "HI & FL sea surface temperatures"
author: "jillashey"
date: "2022-09-13"
output: html_document
---

This script plots the sea surface temperature of HI June 2015 and FL summer 2016. These dates correspond to when the sediment stress experiments were happening in these locations.

## Load packages 
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(lubridate)
library(tidyr)
library(ggplot2)
library(plotrix)
library(tidyverse)
library(dplyr)
library(reshape2)
library(gridExtra)
library(FSA)
library(naniar)
library(scales)
library(cowplot)

```

Before loading data, I separated the text into columns in Excel and deleted the 2nd row (extra header) in each text file. Now all variables should be in their own column and there is only one heading per column. 

## Hawaii temperature 

Hawaii 2015 temperature data was obtained from NOAA buoy (Station 51207 - Kaneohe Bay, HI (198)). 

### Load and organize data 
```{r}
HI_temp <- read.csv("Data/noaa_buoy/KaneoheBay_2015.txt", sep="\t", skip=c(0), header=TRUE, na.strings = "NA")[,c(1:5,15)]
HI_temp$Date <- paste0(HI_temp$X.YY, sep = "-", HI_temp$MM, sep = "-", HI_temp$DD)
HI_temp$Time <- paste0(HI_temp$hh, sep = ":", HI_temp$mm)
HI_temp$Date.Time <- paste0(HI_temp$Date, sep=" ", HI_temp$Time)
HI_temp <- HI_temp %>% naniar::replace_with_na(HI_temp, replace = list(WTMP=c("9   9.", ".0 999", "999", "0 999."))) # replace all weird enteries with NAs
```

### Parse date & time 
```{r}
HI_temp$Date.Time <- as.POSIXct(paste(HI_temp$Date, HI_temp$Time), format="%Y-%m-%d %H:%M", tz = "HST")
```

### Subset for June 1 - June 15
```{r}
HI_temp_sub <- HI_temp %>% 
  filter(Date.Time > as.POSIXct("2015-06-01 00:03:00"), Date.Time < as.POSIXct("2015-06-15 23:00:00"))

#HI_temp%>% filter(Date.Time < as.POSIXct("2015-06-01 08:00:00")) %>%summarise(mean=mean(WTMP),sd=sd(WTMP),se=std.error(WTMP))
```

### Plot Hawaii temps during experimental period 
```{r}
HI_plot <- ggplot(HI_temp_sub, aes(x=Date.Time, y=WTMP)) +
  geom_line(size = 1) + 
  #geom_vline(xintercept = c("2015-06-08 12:00:00"), linetype = "dotted", color = "blue", size = 1.5) +
  #geom_vline(xintercept = as.numeric(date_range), linetype = "dotted", color = "blue", size = 1.5) +
  theme(plot.margin = margin(1,1,1,1, "cm")) +
  scale_x_datetime(date_breaks = "1 day", labels = date_format("%b %d")) + 
  ylab("Temperature (°C)") + 
  ggtitle("Water Temperatures in \n Kāneʻohe Bay, Oʻahu, Hawaiʻi (2015)") +
  xlab("") + 
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, 
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size = 5, 
                                   color = "black")) + 
  theme(axis.text.y = element_text(size = 5, color = "black")) +
  theme(axis.title.y = element_text(size = 7, color = "black")) +
  theme(plot.title = element_text(size = 10, color = "black", hjust = 0.5))
HI_plot

# save plot
ggsave("Output/Figs/Temperature/HI_temperature_2015.pdf", HI_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/Temperature/HI_temperature_2015.png", HI_plot, width = 49, height = 40, units = c("in"))
```


## Florida temperature 

Fort Pierce (where experiment took place) 2016 temperature data was obtained from NOAA buoy (Station 41114 - Fort Pierce, FL(134)). 

### Load and organize data 
```{r}
FP_temp <- read.csv("Data/noaa_buoy/FortPierce_2016.txt", sep="\t", skip=c(0), header=TRUE, na.strings = "NA")[,c(1:5,15)]
FP_temp$Date <- paste0(FP_temp$X.YY, sep = "-", FP_temp$MM, sep = "-", FP_temp$DD)
FP_temp$Time <- paste0(FP_temp$hh, sep = ":", FP_temp$mm)
FP_temp$Date.Time <- paste0(FP_temp$Date, sep=" ", FP_temp$Time)
FP_temp <- FP_temp %>% naniar::replace_with_na(FP_temp, replace = list(WTMP=c("999"))) # replace all weird enteries with NAs
FP_temp <- na.omit(FP_temp)
```

### Parse date and time
```{r}
FP_temp$Date.Time <- as.POSIXct(paste(FP_temp$Date, FP_temp$Time), format="%Y-%m-%d %H:%M", tz = "EST")
```

### Subset for May 23 - June 15
```{r}
FP_temp_sub <- FP_temp %>% 
  filter(Date.Time > as.POSIXct("2016-05-23 00:03:00"), Date.Time < as.POSIXct("2016-06-09 23:00:00"))
```

### Plot Florida temps during experimental period 
```{r}
FL_plot <- ggplot(FP_temp_sub, aes(x=Date.Time, y=WTMP)) +
  geom_line(size = 1) + 
  theme(plot.margin = margin(1,1,1,1, "cm")) +
  scale_x_datetime(date_breaks = "1 day", labels = date_format("%b %d")) + 
  ylab("Temperature (°C)") + 
  xlab("") + 
    ggtitle("Water Temperatures in \n Fort Pierce, Florida (2016)") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 45, 
                                   #vjust = 0.5, 
                                   hjust= 1, 
                                   size = 5, 
                                   color = "black")) + 
  theme(axis.text.y = element_text(size = 5, color = "black")) +
  theme(axis.title.y = element_text(size = 7, color = "black")) +
  theme(plot.title = element_text(size = 10, color = "black", hjust = 0.5))
FL_plot

# save plot
ggsave("Output/Figs/Temperature/FL_temperature_2016.pdf", FL_plot, width = 49, height = 40, units = c("in"))
ggsave("Output/Figs/Temperature/FL_temperature_2016.png", FL_plot, width = 49, height = 40, units = c("in"))
```

### Put the HI and FL temperature plots into one figure and save

```{r}
temps <- plot_grid(HI_plot, FL_plot, nrow = 2, align = 'vh', labels = c("A", "B"))
temps

ggsave("Output/Figs/Temperature/FL_HI_Temperatures.pdf", temps, width = 10, height = 5)
ggsave("Output/Figs/Temperature/FL_HI_Temperatures.png", temps, width = 10, height = 5)
```

