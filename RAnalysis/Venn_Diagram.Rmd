---
title: "Sediment Stress venn diagram"
author: "jillashey"
date: "1/19/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Load libraries
library(VennDiagram)
library(tidyverse)
```

Test code from [here](https://www.r-graph-gallery.com/14-venn-diagramm.html)
```{r}
# Generate 3 sets of 200 words
set1 <- paste(rep("word_" , 200) , sample(c(1:1000) , 200 , replace=F) , sep="")
set2 <- paste(rep("word_" , 200) , sample(c(1:1000) , 200 , replace=F) , sep="")
set3 <- paste(rep("word_" , 200) , sample(c(1:1000) , 200 , replace=F) , sep="")

# Prepare a palette of 3 colors with R colorbrewer:
library(RColorBrewer)
myCol <- brewer.pal(3, "Pastel2")

# Chart
venn.diagram(
        x = list(set1, set2, set3),
        category.names = c("Set 1" , "Set 2 " , "Set 3"),
        filename = 'Output/Figs/Venn/test_venn_diagramm.png',
        output=TRUE,
        
        # Output features
        imagetype="png",
        height = 480,
        width = 480,
        resolution = 300,
        compression = "lzw",
        
        # Circles
        lwd = 2,
        lty = 'blank',
        fill = myCol,
        
        # Numbers
        cex = .6,
        fontface = "bold",
        fontfamily = "sans",
        
        # Set names
        cat.cex = 0.6,
        cat.fontface = "bold",
        cat.default.pos = "outer",
        cat.pos = c(-27, 27, 135),
        cat.dist = c(0.055, 0.055, 0.085),
        cat.fontfamily = "sans",
        rotation = 1
)
```

Now try with my data 
Venn diagram including BP, CC, MF
```{r}
# 5-set Venn Diagram

## read in data 
all  <- read.csv("Output/GOSeq/all.go_20220121.csv")
head(all)
all <- all[,-c(1)] # remove weird first col

## subset by species 
acerv <- all %>% filter(Species=="A.cervicornis")
length(unique(acerv$GO.IDs)) # 266 - there are some duplicates because certain terms matched to multiple GO slim terms 
mcav <- all %>% filter(Species=="M.cavernosa")
length(unique(mcav$GO.IDs)) # 22- - there are some duplicates because certain terms matched to multiple GO slim terms 
ofav <- all %>% filter(Species=="O.faveolata")
length(unique(ofav$GO.IDs)) # 39 - there are some duplicates because certain terms matched to multiple GO slim terms 
pacuta <- all %>% filter(Species=="P.acuta") 
length(unique(pacuta$GO.IDs)) # 532 - there are some duplicates because certain terms matched to multiple GO slim terms 
plob <- all %>% filter(Species=="P.lobata") 
length(unique(plob$GO.IDs)) # 279 - there are some duplicates because certain terms matched to multiple GO slim terms 

## Plot 
venn.plot <- venn.diagram(
	x = list(
		A.cervicornis = acerv$GO.IDs,
		M.cavernosa = mcav$GO.IDs,
		O.faveolata = ofav$GO.IDs,
		P.acuta = pacuta$GO.IDs,
		P.lobata = plob$GO.IDs
		),
	filename = "Output/Figs/Venn/venn_GO.png",
	col = "black",
	fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	alpha = 0.50,
	cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,
	 1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
	cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	cat.cex = 1.5,
	cat.fontface = "bold",
	margin = 0.1
	)
```

Venn diagram - ONLY BP
```{r}
# 5-set Venn Diagram

## read in data 
all.BP  <- read.csv("Output/GOSeq/all.go.BP_20220121.csv")
head(all.BP)
all.BP <- all.BP[,-c(1)] # remove weird first col

## subset by species 
acerv <- all.BP %>% filter(Species=="A.cervicornis")
length(unique(acerv$GO.IDs)) # 278 - there are some duplicates because certain terms matched to multiple GO slim terms 
mcav <- all.BP %>% filter(Species=="M.cavernosa")
length(unique(mcav$GO.IDs)) # 158 - there are some duplicates because certain terms matched to multiple GO slim terms 
ofav <- all.BP %>% filter(Species=="O.faveolata")
length(unique(ofav$GO.IDs)) # 27 - there are some duplicates because certain terms matched to multiple GO slim terms 
pacuta <- all.BP %>% filter(Species=="P.acuta") 
length(unique(pacuta$GO.IDs)) # 380 - there are some duplicates because certain terms matched to multiple GO slim terms 
plob <- all.BP %>% filter(Species=="P.lobata") 
length(unique(plob$GO.IDs)) # 198 - there are some duplicates because certain terms matched to multiple GO slim terms 

## Plot 
venn.plot <- venn.diagram(
	x = list(
		A.cervicornis = acerv$GO.IDs,
		M.cavernosa = mcav$GO.IDs,
		O.faveolata = ofav$GO.IDs,
		P.acuta = pacuta$GO.IDs,
		P.lobata = plob$GO.IDs
		),
	filename = "Output/Figs/Venn/venn_GO.BP.png",
	col = "black",
	fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	alpha = 0.50,
	cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,
	 1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
	cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	cat.cex = 1.5,
	cat.fontface = "bold",
	margin = 0.1
	)

# intersections to check against figure 
intersect(acerv$GO.IDs, mcav$GO.IDs)
intersect(acerv$GO.IDs, ofav$GO.IDs)
intersect(acerv$GO.IDs, pacuta$GO.IDs)
intersect(acerv$GO.IDs, plob$GO.IDs)
intersect(pacuta$GO.IDs, mcav$GO.IDs)
intersect(plob$GO.IDs, mcav$GO.IDs)
intersect(pacuta$GO.IDs, ofav$GO.IDs)
intersect(pacuta$GO.IDs, plob$GO.IDs)
```

Venn diagram - ONLY CC
```{r}
# 5-set Venn Diagram

## read in data 
all.CC  <- read.csv("Output/GOSeq/all.go.CC_20220125.csv")
head(all.CC)
all.CC <- all.CC[,-c(1)] # remove weird first col

## subset by species 
acerv <- all.CC %>% filter(Species=="A.cervicornis")
length(unique(acerv$GO.IDs)) # 34 - there are some duplicates because certain terms matched to multiple GO slim terms 
mcav <- all.CC %>% filter(Species=="M.cavernosa")
length(unique(mcav$GO.IDs)) # 21 - there are some duplicates because certain terms matched to multiple GO slim terms 
ofav <- all.CC %>% filter(Species=="O.faveolata")
length(unique(ofav$GO.IDs)) # 3 - there are some duplicates because certain terms matched to multiple GO slim terms 
pacuta <- all.CC %>% filter(Species=="P.acuta") 
length(unique(pacuta$GO.IDs)) # 25 - there are some duplicates because certain terms matched to multiple GO slim terms 
plob <- all.CC %>% filter(Species=="P.lobata") 
length(unique(plob$GO.IDs)) # 31 - there are some duplicates because certain terms matched to multiple GO slim terms 

## Plot 
venn.plot <- venn.diagram(
	x = list(
		A.cervicornis = acerv$GO.IDs,
		M.cavernosa = mcav$GO.IDs,
		O.faveolata = ofav$GO.IDs,
		P.acuta = pacuta$GO.IDs,
		P.lobata = plob$GO.IDs
		),
	filename = "Output/Figs/Venn/venn_GO.CC.png",
	col = "black",
	fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	alpha = 0.50,
	cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,
	 1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
	cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	cat.cex = 1.5,
	cat.fontface = "bold",
	margin = 0.1
	)
```

Venn diagram - ONLY MF
```{r}
# 5-set Venn Diagram

## read in data 
all.MF  <- read.csv("Output/GOSeq/all.go.MF_20220125.csv")
head(all.MF)
all.MF <- all.MF[,-c(1)] # remove weird first col

## subset by species 
acerv <- all.MF %>% filter(Species=="A.cervicornis")
length(unique(acerv$GO.IDs)) # 54 - there are some duplicates because certain terms matched to multiple GO slim terms 
mcav <- all.MF %>% filter(Species=="M.cavernosa")
length(unique(mcav$GO.IDs)) # 39 - there are some duplicates because certain terms matched to multiple GO slim terms 
ofav <- all.MF %>% filter(Species=="O.faveolata")
length(unique(ofav$GO.IDs)) # 9 - there are some duplicates because certain terms matched to multiple GO slim terms 
pacuta <- all.MF %>% filter(Species=="P.acuta") 
length(unique(pacuta$GO.IDs)) # 126 - there are some duplicates because certain terms matched to multiple GO slim terms 
plob <- all.MF %>% filter(Species=="P.lobata") 
length(unique(plob$GO.IDs)) # 50 - there are some duplicates because certain terms matched to multiple GO slim terms 

## Plot 
venn.plot <- venn.diagram(
	x = list(
		A.cervicornis = acerv$GO.IDs,
		M.cavernosa = mcav$GO.IDs,
		O.faveolata = ofav$GO.IDs,
		P.acuta = pacuta$GO.IDs,
		P.lobata = plob$GO.IDs
		),
	filename = "Output/Figs/Venn/venn_GO.MF.png",
	col = "black",
	fill = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	alpha = 0.50,
	cex = c(1.5, 1.5, 1.5, 1.5, 1.5, 1, 0.8, 1, 0.8, 1, 0.8, 1, 0.8,
	 1, 0.8, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 0.55, 1, 1, 1, 1, 1, 1.5),
	cat.col = c("dodgerblue", "goldenrod1", "darkorange1", "seagreen3", "orchid3"),
	cat.cex = 1.5,
	cat.fontface = "bold",
	margin = 0.1
	)
```

```{r}
# easy way to find some way to list overlap?
#intersect(xx$a, yy$a)
```














