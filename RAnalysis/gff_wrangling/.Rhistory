#Load libraries
library(tidyverse)
#Load  gene gff
Acerv.gff <- read.csv(file="~/Desktop/GFFs/Acerv_assembly_v1.0.gff3", header=FALSE, sep="\t", skip=1)
View(Acerv.gff)
#rename columns
colnames(Acerv.gff) <- c("scaffold", "Gene.Predict", "id", "gene.start","gene.stop", "pos1", "pos2","pos3", "gene")
head(Acerv.gff)
Acerv.gff$transcript_id <- sub(";.*", "", Acerv.gff$gene)
View(Acerv.gff)
Acerv.gff$transcript_id <- gsub("ID=", "", Acerv.gff$transcript_id) #remove ID=
# Checking what kinds of ids are in gff
unique(Acerv.gff$id)
#If id == mRNA, exon, five_prime_UTR, three_prime_UTR, CDS, add ;transcript_id= <gene line ID without ID= stopping at first ; , else replace with original gene
Acerv.gff <- Acerv.gff %>%
mutate(gene = ifelse(id != "gene", paste0(gene, ";transcript_id=", Acerv.gff$transcript_id),  paste0(gene)))
View(Acerv.gff)
#save file
write.table(Acerv.gff, file="~/Desktop/GFFs/Acerv.GFFannotations.fixed_transcript.gff3", sep="\t", col.names = FALSE, row.names=FALSE, quote=FALSE)
#Load  gene gff
Mcav.gff <- read.csv(file="~/Desktop/GFFs/Mcavernosa.maker.coding.gff3", header=FALSE, sep="\t", skip=1)
View(Mcav.gff)
#rename columns
colnames(Mcav.gff) <- c("scaffold", "Gene.Predict", "id", "gene.start","gene.stop", "pos1", "pos2","pos3", "gene")
head(Mcav.gff)
# Creating transcript id
Mcav.gff$transcript_id <- sub(";.*", "", Mcav.gff$gene)
Mcav.gff$transcript_id <- gsub("ID=", "", Mcav.gff$transcript_id) #remove ID=
# Checking what kinds of ids are in gff
unique(Mcav.gff$id)
#If id == mRNA, exon, five_prime_UTR, three_prime_UTR, CDS, add ;transcript_id= <gene line ID without ID= stopping at first ; , else replace with original gene
Mcav.gff <- Mcav.gff %>%
mutate(gene = ifelse(id != "gene", paste0(gene, ";transcript_id=", Mcav.gff$transcript_id),  paste0(gene)))
head(Mcav.gff)
# Remove last col
Mcav.gff <- Mcav.gff[,-10]
head(Mcav.gff)
#save file
write.table(Mcav.gff, file="~/Desktop/GFFs/Mcav.gff.annotations.fixed_transcript.gff3", sep="\t", col.names = FALSE, row.names=FALSE, quote=FALSE)
#Load  gene gff
Mcav.gff <- read.csv(file="~/Desktop/GFFs/Mcavernosa.maker.coding.gff3", header=FALSE, sep="\t", skip=1)
View(Mcav.gff)
View(Acerv.gff)
